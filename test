Sub HighlightDifferences_Sheet2()
    Dim ws As Worksheet
    Set ws = ThisWorkbook.Sheets("Sheet2") ' 明确指定Sheet2
    
    ' 定义表A（主表）和表B（需标黄表）范围
    Dim rngA As Range, rngB As Range
    Set rngA = ws.Range("A253:AW269") ' 表A范围（根据实际调整）
    Set rngB = ws.Range("A277:AW289") ' 表B范围（根据实际调整）
    
    ' 清除旧格式
    rngB.Interior.Pattern = xlNone
    
    ' 比较逻辑
    Dim cell As Range
    For Each cell In rngB.Columns(1).Cells ' 遍历表B的employer_account_code列(A列)
        If cell.Value <> "" Then
            ' 在表A中查找匹配行（A列和I列双条件）
            Dim matchRow As Long
            matchRow = 0
            For i = 1 To rngA.Rows.Count
                If rngA.Cells(i, 1).Value = cell.Value And _
                   rngA.Cells(i, 9).Value = cell.Offset(0, 8).Value Then ' I列是第9列
                    matchRow = i
                    Exit For
                End If
            Next i
            
            ' 如果找到匹配行，逐列比较
            If matchRow > 0 Then
                For col = 1 To rngB.Columns.Count
                    If cell.Offset(0, col - 1).Value <> rngA.Cells(matchRow, col).Value Then
                        cell.Offset(0, col - 1).Interior.Color = RGB(255, 255, 0) ' 黄色
                    End If
                Next col
            End If
        End If
    Next cell
    
    MsgBox "差异标记完成！", vbInformation
End Sub

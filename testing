import ctypes
import time
from IPython.display import clear_output

# é˜²æ­¢ç³»ç»Ÿè¿›å…¥ç©ºé—²çŠ¶æ€çš„ç»“æ„ä½“
class LASTINPUTINFO(ctypes.Structure):
    _fields_ = [('cbSize', ctypes.c_uint), ('dwTime', ctypes.c_uint)]

# è°ƒç”¨ Windows API è®¾ç½®ç³»ç»ŸçŠ¶æ€ä¸ºæ´»è·ƒ
def prevent_sleep():
    ctypes.windll.kernel32.SetThreadExecutionState(0x80000002)

# æ˜¾ç¤ºè¿è¡ŒçŠ¶æ€ï¼ˆé˜²æ­¢ Jupyter kernel è¢« killï¼‰
run_minutes = 120
interval = 30  # æ¯30ç§’åˆ·æ–°/æ¿€æ´»ä¸€æ¬¡
print(f"ğŸŸ¢ å¼€å§‹é˜²æ‰çº¿ï¼ˆé˜²Teamsç¦»å¼€ã€ç³»ç»Ÿé”å±ï¼‰ã€‚é¢„è®¡æŒç»­è¿è¡Œ {run_minutes} åˆ†é’Ÿï¼Œæ¯ {interval} ç§’åˆ·æ–°ä¸€æ¬¡ã€‚")

try:
    for i in range(int(run_minutes * 60 / interval)):
        prevent_sleep()
        clear_output(wait=True)
        print(f"âœ… ç¬¬ {i+1} æ¬¡æ¿€æ´»ç³»ç»Ÿï¼Œå·²è¿è¡Œ {((i+1)*interval)//60} åˆ†é’Ÿ")
        time.sleep(interval)

    print("ğŸŸ¢ é˜²æ‰çº¿ä»»åŠ¡å®Œæˆ")

except KeyboardInterrupt:
    print("â›” å·²æ‰‹åŠ¨ç»ˆæ­¢é˜²æ‰çº¿è„šæœ¬")

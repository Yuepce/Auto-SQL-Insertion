import pandas as pd

def generate_sql_queries(df: pd.DataFrame, table_name: str, use_star=True) -> list:
    """
    根据输入 DataFrame 自动生成 SQL SELECT 语句列表。
    
    参数：
    - df: 包含employer_account_code和member_account_code等列的数据
    - table_name: 数据库中对应的表名
    - use_star: 是否使用 SELECT *（默认True），否则用具体列名

    返回：一个SQL查询语句列表，每条语句只需要一个唯一值做WHERE条件
    """
    sql_list = []

    # 获取列名列表（供select使用）
    all_columns = df.columns.tolist()
    select_clause = "*" if use_star else ", ".join(all_columns)

    for _, row in df.iterrows():
        # 优先使用非空的唯一字段（以employer优先）
        if pd.notna(row.get("employer_account_code")):
            value = row["employer_account_code"]
            where_clause = f"employer_account_code = '{value}'"
        elif pd.notna(row.get("member_account_code")):
            value = row["member_account_code"]
            where_clause = f"member_account_code = '{value}'"
        else:
            continue  # 跳过全空行
        
        sql = f"SELECT {select_clause} FROM {table_name} WHERE {where_clause};"
        sql_list.append(sql)

    return sql_list


# 假设你读取了Excel或CSV：
df = pd.read_excel("your_file.xlsx")  # 或 pd.read_csv(...)

# 生成 SQL 查询语句：
queries = generate_sql_queries(df, table_name="your_table_name")

# 打印其中几条看看：
for q in queries[:5]:
    print(q)
